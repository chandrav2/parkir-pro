<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Sistem Parkir</title>

<style>
:root{
  --card:#ffffff10;
  --neon:#00eaff;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Segoe UI,Arial;
  color:#fff;
  background:linear-gradient(#000000aa,#000000aa),
  url('https://images.unsplash.com/photo-1506521781263-d8422e82f27a');
  background-size:cover;
}
header{
  display:flex;
  justify-content:space-between;
  padding:15px;
  background:var(--card);
  backdrop-filter:blur(10px);
}
button{
  padding:6px 12px;
  background:transparent;
  border:1px solid var(--neon);
  color:var(--neon);
  border-radius:6px;
  cursor:pointer;
}
button:hover{background:var(--neon);color:#000}
.section{
  margin:15px;
  padding:15px;
  background:var(--card);
  border-radius:12px;
  backdrop-filter:blur(10px);
}
.hidden{display:none}
pre{
  background:#000;
  padding:10px;
  border-radius:8px;
  border:1px dashed var(--neon);
}
</style>
</head>

<body>

<header>
<h2>SISTEM PARKIR</h2>
<div id="userInfo"></div>
<button onclick="logout()">Logout</button>
</header>

<!-- LOGIN -->
<div id="loginBox" class="section">
<input id="luser" placeholder="Username"><br><br>
<input id="lpass" type="password" placeholder="Password"><br><br>
<button onclick="login()">Login</button>
</div>

<!-- MENU -->
<div id="menu" class="section hidden">
<button onclick="show('kendaraan')">Kendaraan</button>
<button onclick="show('sensor')">Sensor</button>
<button onclick="show('transaksi')">Transaksi</button>
<button id="rekapBtn" onclick="show('rekap')">Rekap</button>
</div>

<!-- KENDARAAN -->
<div id="kendaraan" class="section hidden">
<h3>Tambah Kendaraan</h3>
<input id="k_plat" placeholder="Plat Nomor">
<select id="k_jenis">
<option>Motor</option>
<option>Mobil</option>
</select>
<button onclick="addKendaraan()">Tambah</button>
<div id="kendaraanList"></div>
</div>

<!-- SENSOR -->
<div id="sensor" class="section hidden">
<h3>Sensor Masuk / Keluar</h3>
<select id="sensor_plat"></select><br><br>
<button onclick="masuk()">üö¶ Masuk</button>
<button onclick="keluar()">üõë Keluar</button>
<div id="sensorInfo"></div>
</div>

<!-- TRANSAKSI -->
<div id="transaksi" class="section hidden">
<h3>Struk Parkir</h3>
<div id="struk"></div>
</div>

<!-- REKAP -->
<div id="rekap" class="section hidden">
<h3>Rekap (Admin)</h3>
<div id="rekapList"></div>
</div>

<script>
// ===== USER LOGIN =====
let users=[
  {u:'admin',p:'admin123',r:'admin'},
  {u:'petugas',p:'petugas123',r:'user'}
]
let currentUser=null

// ===== DATA =====
let kendaraan=[]
let parkir=[]
let tarif={
  Motor:2000,
  Mobil:5000
}

// ===== LOGIN =====
function login(){
currentUser=users.find(x=>x.u==luser.value && x.p==lpass.value)
if(!currentUser) return alert("Login gagal")

loginBox.classList.add('hidden')
menu.classList.remove('hidden')
userInfo.innerHTML=`Login: ${currentUser.u} (${currentUser.r})`

// role check
document.getElementById('rekapBtn').style.display=
  currentUser.r=='admin'?'inline-block':'none'

show('kendaraan')
}

function logout(){location.reload()}

function show(id){
document.querySelectorAll('.section').forEach(x=>x.classList.add('hidden'))
document.getElementById(id).classList.remove('hidden')
menu.classList.remove('hidden')
}

// ===== KENDARAAN =====
function addKendaraan(){
kendaraan.push({plat:k_plat.value,jenis:k_jenis.value})
refresh()
}

// ===== SENSOR =====
function masuk(){
parkir.push({
plat:sensor_plat.value,
masuk:new Date(),
keluar:null
})
sensorInfo.innerHTML="‚úÖ Kendaraan MASUK"
}

function keluar(){
let data=parkir.find(p=>p.plat==sensor_plat.value && !p.keluar)
data.keluar=new Date()

let jam=Math.ceil((data.keluar-data.masuk)/3600000)
let jenis=kendaraan.find(k=>k.plat==data.plat).jenis
let total=jam*tarif[jenis]

struk.innerHTML=`
<pre>
STRUK PARKIR
------------------
Plat   : ${data.plat}
Jenis  : ${jenis}
Masuk  : ${data.masuk.toLocaleString()}
Keluar : ${data.keluar.toLocaleString()}
Durasi : ${jam} Jam
Total  : Rp ${total}
</pre>
<button onclick="window.print()">üñ®Ô∏è Cetak Struk</button>
`

rekapList.innerHTML+=`${data.plat} | ${jenis} | ${jam} jam | Rp ${total}<br>`
show('transaksi')
}

// ===== REFRESH =====
function refresh(){
kendaraanList.innerHTML=kendaraan.map(k=>`${k.plat} - ${k.jenis}`).join("<br>")
sensor_plat.innerHTML=kendaraan.map(k=>`<option>${k.plat}</option>`).join('')
}
</script>

</body>
</html>

